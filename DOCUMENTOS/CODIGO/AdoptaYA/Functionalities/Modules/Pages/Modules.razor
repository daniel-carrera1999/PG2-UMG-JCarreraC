@page "/modulos"

@using AdoptaYA.Functionalities.Modules.Model;

<SessionValidator title="Módulos" path="/modulos">
    <Loader Loading="loading" />

    <RadzenCard Class="rz-mb-4">
        <RadzenTemplateForm TItem="Modulo" Data="@newModulo">
            <RadzenRow Gap="1rem">
                <RadzenColumn Size="12" SizeMD="3" class="rz-display-flex rz-align-items-center">
                    <RadzenFormField Text="Nombre" Variant="Variant.Outlined">
                        <RadzenTextBox @bind-Value="@newModulo.Name" Placeholder="Nombre del módulo" />
                    </RadzenFormField>
                </RadzenColumn>

                <RadzenColumn Size="12" SizeMD="3" class="rz-display-flex rz-align-items-center">
                    <RadzenFormField Text="Path" Variant="Variant.Outlined">
                        <RadzenTextBox @bind-Value="@newModulo.Path" Placeholder="/ruta" />
                    </RadzenFormField>
                </RadzenColumn>

                <RadzenColumn Size="12" SizeMD="3" class="rz-display-flex rz-align-items-center">
                    <RadzenFormField Text="Descripción" Variant="Variant.Outlined">
                        <RadzenTextBox @bind-Value="@newModulo.Description" Placeholder="Descripción del módulo" />
                    </RadzenFormField>
                </RadzenColumn>

                <RadzenColumn Size="12" SizeMD="2" class="rz-display-flex rz-align-items-center">
                    <RadzenFormField Text="Icono" Variant="Variant.Outlined">
                        <RadzenTextBox @bind-Value="@newModulo.Icon" Placeholder="fa-icon" />
                    </RadzenFormField>
                </RadzenColumn>

                <RadzenColumn Size="12" SizeMD="1" class="rz-display-flex rz-align-items-center">
                    @if (!isEdit)
                    {
                        <RadzenButton ButtonType="ButtonType.Submit" ButtonStyle="ButtonStyle.Primary" Icon="add" Click="@AddModulo" Disabled="@IsFormIncomplete" />
                    } 
                    else
                    {
                        <RadzenButton ButtonType="ButtonType.Submit" ButtonStyle="ButtonStyle.Primary" Icon="check_circle" Click="@UpdateModulo" Disabled="@IsFormIncomplete" />
                        <RadzenButton ButtonType="ButtonType.Button" ButtonStyle="ButtonStyle.Danger" Icon="cancel" Click="@CancelUpdate" class="rz-ms-1" />
                    }
                </RadzenColumn>
            </RadzenRow>
        </RadzenTemplateForm>
    </RadzenCard>

    <RadzenDataGrid Data="@modulos" AllowPaging="true" PageSize="10" ColumnWidth="200px"
                    AllowRowSelectOnRowClick="true" SelectionMode="DataGridSelectionMode.Single"
                    FilterMode="FilterMode.CheckBoxList" AllowSorting="true" AllowFiltering="true"
                    ApplyFilterText="Aplicar" ClearFilterText="Limpiar" EmptyText="No hay registros para mostrar">
        <Columns>
            <RadzenDataGridColumn Property="Id" Title="Id" Width="100px" />
            <RadzenDataGridColumn TextAlign="TextAlign.Center" Sortable="false" Filterable="false" Width="50px">
                <Template Context="modulo">
                    <RadzenIcon Icon="@modulo.Icon" />
                </Template>
            </RadzenDataGridColumn>
            <RadzenDataGridColumn Property="Name" Title="Nombre" />
            <RadzenDataGridColumn Property="Path" Title="Path" />
            <RadzenDataGridColumn Property="Description" Title="Descripción" />
            <RadzenDataGridColumn Filterable="false" Sortable="false" Width="140px">
                <Template Context="item">
                    <RadzenStack Orientation="Orientation.Horizontal" JustifyContent="JustifyContent.End" Gap="0.5rem">
                        <RadzenButton Click="@(() => SetUpdate(item))" Icon="edit" Size="ButtonSize.Medium" ButtonStyle="ButtonStyle.Warning" />
                        <RadzenButton Click="@(() => DeleteModulo(item.Id))" Icon="delete" Size="ButtonSize.Medium" ButtonStyle="ButtonStyle.Danger" />
                    </RadzenStack>
                </Template>
            </RadzenDataGridColumn>
        </Columns>
    </RadzenDataGrid>

</SessionValidator>
