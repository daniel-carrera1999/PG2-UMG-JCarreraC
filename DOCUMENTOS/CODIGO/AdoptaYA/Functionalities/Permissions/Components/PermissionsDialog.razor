@page "/rol-detalle"

@using AdoptaYA.Functionalities.Permissions.Model;

<Loader Loading="@loading" />

<RadzenStack Gap="1.5rem">

    @if (Rol != null)
    {
        <!-- Información básica del rol -->
        <RadzenCard>
            <RadzenStack Gap="0.5rem">
                <RadzenText TextStyle="TextStyle.H6" TagName="TagName.H2">Datos Generales</RadzenText>
                <RadzenRow>
                    <RadzenColumn Size="12" SizeMD="6">
                        <RadzenText TextStyle="TextStyle.Subtitle2" class="rz-color-secondary">ID:</RadzenText>
                        <RadzenText TextStyle="TextStyle.Body1">@Rol.Id</RadzenText>
                    </RadzenColumn>
                    <RadzenColumn Size="12" SizeMD="6">
                        <RadzenText TextStyle="TextStyle.Subtitle2" class="rz-color-secondary">Nombre:</RadzenText>
                        <RadzenText TextStyle="TextStyle.Body1">@Rol.Name</RadzenText>
                    </RadzenColumn>
                </RadzenRow>
                <RadzenRow>
                    <RadzenColumn Size="12">
                        <RadzenText TextStyle="TextStyle.Subtitle2" class="rz-color-secondary">Descripción:</RadzenText>
                        <RadzenText TextStyle="TextStyle.Body1">@Rol.Description</RadzenText>
                    </RadzenColumn>
                </RadzenRow>
            </RadzenStack>
        </RadzenCard>

        <!-- Permisos del rol -->
        <RadzenCard>
            <RadzenStack Gap="1rem">
                <RadzenText TextStyle="TextStyle.H6" TagName="TagName.H2">Permisos del Rol</RadzenText>

                <RadzenDataGrid @ref="grid" Data="@MatrizPermisos" TItem="ModuloPermisoViewModel" AllowSorting="true"
                                ShowPagingSummary="true" AllowPaging="true" PageSize="10" ColumnWidth="200px">
                    <Columns>
                        <RadzenDataGridColumn TItem="ModuloPermisoViewModel" Property="Name" Title="Módulo" Width="250px">
                            <Template Context="item">
                                <RadzenStack Orientation="Orientation.Horizontal" Gap="0.5rem" AlignItems="AlignItems.Center">
                                    <RadzenIcon Icon="@item.Icon" />
                                    <RadzenStack Gap="0">
                                        <RadzenText TextStyle="TextStyle.Body1">@item.Name</RadzenText>
                                        <RadzenText TextStyle="TextStyle.Caption" class="rz-color-secondary">@item.Description</RadzenText>
                                    </RadzenStack>
                                </RadzenStack>
                            </Template>
                        </RadzenDataGridColumn>

                        <RadzenDataGridColumn TItem="ModuloPermisoViewModel" Title="Crear" Width="120px" TextAlign="TextAlign.Center">
                            <Template Context="item">
                                <RadzenCheckBox @bind-Value="@item.Create" Change="@(async (bool value) => await SetPermissionAsync(item, value))" />
                            </Template>
                        </RadzenDataGridColumn>

                        <RadzenDataGridColumn TItem="ModuloPermisoViewModel" Title="Leer" Width="120px" TextAlign="TextAlign.Center">
                            <Template Context="item">
                                <RadzenCheckBox @bind-Value="@item.Read" Change="@(async (bool value) => await SetPermissionAsync(item, value))" />
                            </Template>
                        </RadzenDataGridColumn>

                        <RadzenDataGridColumn TItem="ModuloPermisoViewModel" Title="Actualizar" Width="120px" TextAlign="TextAlign.Center">
                            <Template Context="item">
                                <RadzenCheckBox @bind-Value="@item.Update" Change="@(async (bool value) => await SetPermissionAsync(item, value))" />
                            </Template>
                        </RadzenDataGridColumn>

                        <RadzenDataGridColumn TItem="ModuloPermisoViewModel" Title="Eliminar" Width="120px" TextAlign="TextAlign.Center">
                            <Template Context="item">
                                <RadzenCheckBox @bind-Value="@item.Delete" Change="@(async (bool value) => await SetPermissionAsync(item, value))" />
                            </Template>
                        </RadzenDataGridColumn>
                    </Columns>
                </RadzenDataGrid>
            </RadzenStack>
        </RadzenCard>

    }
    else
    {
        <RadzenText TextStyle="TextStyle.Body1">No se encontró información del rol.</RadzenText>
    }
</RadzenStack>