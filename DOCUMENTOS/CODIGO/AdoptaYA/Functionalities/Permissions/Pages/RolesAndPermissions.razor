@page "/roles"

@using AdoptaYA.Functionalities.Permissions.Model

<SessionValidator title="Roles y Permisos" path="/roles">
    <Loader Loading="loading" />

    <RadzenCard Class="rz-mb-4">
        <RadzenTemplateForm TItem="Rol" Data="@newRol">
            <RadzenRow Gap="1rem">
                <RadzenColumn Size="12" SizeMD="3" class="rz-display-flex rz-align-items-center">
                    <RadzenFormField Text="Nombre" Variant="Variant.Outlined">
                        <RadzenTextBox @bind-Value="@newRol.Name" Placeholder="Nombre del módulo" />
                    </RadzenFormField>
                </RadzenColumn>

                <RadzenColumn Size="12" SizeMD="3" class="rz-display-flex rz-align-items-center">
                    <RadzenFormField Text="Descripción" Variant="Variant.Outlined">
                        <RadzenTextBox @bind-Value="@newRol.Description" Placeholder="Descripción del módulo" />
                    </RadzenFormField>
                </RadzenColumn>

                <RadzenColumn Size="12" SizeMD="1" class="rz-display-flex rz-align-items-center">
                    @if (!isEdit)
                    {
                        <RadzenButton ButtonType="ButtonType.Submit" ButtonStyle="ButtonStyle.Primary" Icon="add" Click="@AddRol" Disabled="@IsFormIncomplete" />
                    }
                    else
                    {
                        <RadzenButton ButtonType="ButtonType.Submit" ButtonStyle="ButtonStyle.Primary" Icon="check_circle" Click="@UpdateRol" Disabled="@IsFormIncomplete" />
                        <RadzenButton ButtonType="ButtonType.Button" ButtonStyle="ButtonStyle.Danger" Icon="cancel" Click="@CancelUpdate" class="rz-ms-1" />
                    }
                </RadzenColumn>
            </RadzenRow>
        </RadzenTemplateForm>
    </RadzenCard>

    <RadzenDataGrid Data="@roles" TItem="Rol" AllowPaging="true" PageSize="10" ColumnWidth="200px"
                    AllowRowSelectOnRowClick="true" SelectionMode="DataGridSelectionMode.Single"
                    FilterMode="FilterMode.CheckBoxList" AllowSorting="true" AllowFiltering="true"
                    ApplyFilterText="Aplicar" ClearFilterText="Limpiar" EmptyText="No hay registros para mostrar">
        <Columns>
            <RadzenDataGridColumn TItem="Rol" Property="Id" Title="Id Rol" Width="125px" />
            <RadzenDataGridColumn TItem="Rol" Property="Name" Title="Nombre" />
            <RadzenDataGridColumn TItem="Rol" Property="Description" Title="Descripción" />
            <RadzenDataGridColumn TItem="Rol" Filterable="false" Sortable="false" Width="140px">
                <Template Context="item">
                    <RadzenStack Orientation="Orientation.Horizontal" JustifyContent="JustifyContent.End" Gap="0.5rem">
                        <RadzenButton Click="@(() => OpenManagePermissions(item))" Icon="dashboard_2" Size="ButtonSize.Medium" ButtonStyle="ButtonStyle.Primary" />
                        <RadzenButton Click="@(() => SetUpdate(item))" Icon="edit" Size="ButtonSize.Medium" ButtonStyle="ButtonStyle.Warning" />
                        <RadzenButton Click="@(() => DeleteRol(item.Id))" Icon="delete" Size="ButtonSize.Medium" ButtonStyle="ButtonStyle.Danger" />
                    </RadzenStack>
                </Template>
            </RadzenDataGridColumn>
        </Columns>
    </RadzenDataGrid>
</SessionValidator>